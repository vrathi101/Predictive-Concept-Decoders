W0106 03:23:41.438000 27834 torch/distributed/run.py:803] 
W0106 03:23:41.438000 27834 torch/distributed/run.py:803] *****************************************
W0106 03:23:41.438000 27834 torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0106 03:23:41.438000 27834 torch/distributed/run.py:803] *****************************************
/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Note: Environment variable`HF_TOKEN` is set and is the current active token independently from the token you've just configured.
Note: Environment variable`HF_TOKEN` is set and is the current active token independently from the token you've just configured.
Fetching 2 files:   0%|                                                                                                          | 0/2 [00:00<?, ?it/s]Fetching 2 files:   0%|                                                                                                          | 0/2 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py:798: UserWarning: Not enough free disk space to download the file. The expected file size is: 4965.80 MB. The target location /root/.cache/huggingface/transformers/models--meta-llama--Llama-3.2-3B-Instruct/blobs only has 3711.17 MB free disk space.
  warnings.warn(
Fetching 2 files:   0%|                                                                                                          | 0/2 [00:04<?, ?it/s]
[rank1]: Traceback (most recent call last):
[rank1]:   File "/workspace/predictive_concept_decoders/pcd_parquet_download.py", line 160, in <module>
[rank1]:     subject, tokenizer, config = load_model_and_tokenizer()
[rank1]:                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/workspace/predictive_concept_decoders/pcd_parquet_download.py", line 109, in load_model_and_tokenizer
[rank1]:     model = AutoModelForCausalLM.from_pretrained(
[rank1]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
[rank1]:     return model_class.from_pretrained(
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/modeling_utils.py", line 277, in _wrapper
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/modeling_utils.py", line 4900, in from_pretrained
[rank1]:     checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
[rank1]:                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/modeling_utils.py", line 1200, in _get_resolved_checkpoint_files
[rank1]:     checkpoint_files, sharded_metadata = get_checkpoint_shard_files(
[rank1]:                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py", line 1084, in get_checkpoint_shard_files
[rank1]:     cached_filenames = cached_files(
[rank1]:                        ^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py", line 567, in cached_files
[rank1]:     raise e
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py", line 494, in cached_files
[rank1]:     snapshot_download(
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/_snapshot_download.py", line 332, in snapshot_download
[rank1]:     thread_map(
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/tqdm/contrib/concurrent.py", line 69, in thread_map
[rank1]:     return _executor_map(ThreadPoolExecutor, fn, *iterables, **tqdm_kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/tqdm/contrib/concurrent.py", line 51, in _executor_map
[rank1]:     return list(tqdm_class(ex.map(fn, *iterables, chunksize=chunksize), **kwargs))
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/tqdm/std.py", line 1181, in __iter__
[rank1]:     for obj in iterable:
[rank1]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 619, in result_iterator
[rank1]:     yield _result_or_cancel(fs.pop())
[rank1]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 317, in _result_or_cancel
[rank1]:     return fut.result(timeout)
[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 456, in result
[rank1]:     return self.__get_result()
[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
[rank1]:     raise self._exception
[rank1]:   File "/usr/lib/python3.11/concurrent/futures/thread.py", line 58, in run
[rank1]:     result = self.fn(*self.args, **self.kwargs)
[rank1]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/_snapshot_download.py", line 306, in _inner_hf_hub_download
[rank1]:     return hf_hub_download(
[rank1]:            ^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
[rank1]:     return _hf_hub_download_to_cache_dir(
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 1168, in _hf_hub_download_to_cache_dir
[rank1]:     _download_to_tmp_and_move(
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 1720, in _download_to_tmp_and_move
[rank1]:     xet_get(
[rank1]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 626, in xet_get
[rank1]:     download_files(
[rank1]: RuntimeError: Data processing error: CAS service error : IO Error: No space left on device (os error 28)
/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py:798: UserWarning: Not enough free disk space to download the file. The expected file size is: 4965.80 MB. The target location /root/.cache/huggingface/transformers/models--meta-llama--Llama-3.2-3B-Instruct/blobs only has 0.94 MB free disk space.
  warnings.warn(
Fetching 2 files:   0%|                                                                                                          | 0/2 [00:05<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/workspace/predictive_concept_decoders/pcd_parquet_download.py", line 160, in <module>
[rank0]:     subject, tokenizer, config = load_model_and_tokenizer()
[rank0]:                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/workspace/predictive_concept_decoders/pcd_parquet_download.py", line 109, in load_model_and_tokenizer
[rank0]:     model = AutoModelForCausalLM.from_pretrained(
[rank0]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/models/auto/auto_factory.py", line 604, in from_pretrained
[rank0]:     return model_class.from_pretrained(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/modeling_utils.py", line 277, in _wrapper
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/modeling_utils.py", line 4900, in from_pretrained
[rank0]:     checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
[rank0]:                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/modeling_utils.py", line 1200, in _get_resolved_checkpoint_files
[rank0]:     checkpoint_files, sharded_metadata = get_checkpoint_shard_files(
[rank0]:                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py", line 1084, in get_checkpoint_shard_files
[rank0]:     cached_filenames = cached_files(
[rank0]:                        ^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py", line 567, in cached_files
[rank0]:     raise e
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/transformers/utils/hub.py", line 494, in cached_files
[rank0]:     snapshot_download(
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/_snapshot_download.py", line 332, in snapshot_download
[rank0]:     thread_map(
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/tqdm/contrib/concurrent.py", line 69, in thread_map
[rank0]:     return _executor_map(ThreadPoolExecutor, fn, *iterables, **tqdm_kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/tqdm/contrib/concurrent.py", line 51, in _executor_map
[rank0]:     return list(tqdm_class(ex.map(fn, *iterables, chunksize=chunksize), **kwargs))
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/tqdm/std.py", line 1181, in __iter__
[rank0]:     for obj in iterable:
[rank0]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 619, in result_iterator
[rank0]:     yield _result_or_cancel(fs.pop())
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 317, in _result_or_cancel
[rank0]:     return fut.result(timeout)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 456, in result
[rank0]:     return self.__get_result()
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
[rank0]:     raise self._exception
[rank0]:   File "/usr/lib/python3.11/concurrent/futures/thread.py", line 58, in run
[rank0]:     result = self.fn(*self.args, **self.kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/_snapshot_download.py", line 306, in _inner_hf_hub_download
[rank0]:     return hf_hub_download(
[rank0]:            ^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
[rank0]:     return _hf_hub_download_to_cache_dir(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 1168, in _hf_hub_download_to_cache_dir
[rank0]:     _download_to_tmp_and_move(
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 1720, in _download_to_tmp_and_move
[rank0]:     xet_get(
[rank0]:   File "/usr/local/lib/python3.11/dist-packages/huggingface_hub/file_download.py", line 626, in xet_get
[rank0]:     download_files(
[rank0]: RuntimeError: Data processing error: CAS service error : IO Error: No space left on device (os error 28)
[rank0]:[W106 03:24:03.309590806 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0106 03:24:04.092000 27834 torch/distributed/elastic/multiprocessing/api.py:908] Sending process 27903 closing signal SIGTERM
E0106 03:24:04.358000 27834 torch/distributed/elastic/multiprocessing/api.py:882] failed (exitcode: 1) local_rank: 1 (pid: 27904) of binary: /usr/bin/python
Traceback (most recent call last):
  File "/usr/local/bin/torchrun", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/distributed/run.py", line 936, in main
    run(args)
  File "/usr/local/lib/python3.11/dist-packages/torch/distributed/run.py", line 927, in run
    elastic_launch(
  File "/usr/local/lib/python3.11/dist-packages/torch/distributed/launcher/api.py", line 156, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/distributed/launcher/api.py", line 293, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
pcd_parquet_download.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-01-06_03:24:04
  host      : 68d2614c9a61
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 27904)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
